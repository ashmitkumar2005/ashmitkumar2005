# name: Experimental Animated Pac-Man Graph

# on:
#   schedule:
#     - cron: "0 */24 * * *"
#   workflow_dispatch:

# jobs:
#   generate:
#     runs-on: ubuntu-latest
#     permissions:
#       contents: write

#     steps:
#       - name: Checkout repo
#         uses: actions/checkout@v3

#       - name: Generate Base Pac-Man SVG
#         uses: abozanona/pacman-contribution-graph@main
#         with:
#           github_user_name: ${{ github.repository_owner }}
#           smooth_paths: true
#           path_thickness: 2.0
#           path_color: "#444444"
#           pacman_color: "#ffcc00"
#           ghost_color_style: "classic"
#           background_color: "transparent"
#           cell_size: 12
#           spacing: 3

#       - name: Inject Animations
#         run: |
#           FILE="dist/pacman-contribution-graph.svg"

#           # Pac-Man mouth animation
#           sed -i 's/<circle/<circle><animate attributeName="r" values="12;8;12" dur="0.4s" repeatCount="indefinite" \/>/' $FILE

#           # Pac-Man glow
#           sed -i 's/fill="#ffcc00"/fill="#ffcc00"><animate attributeName="fill" values="#ffcc00;#ffee88;#ffcc00" dur="1s" repeatCount="indefinite" \/><\/circle>/' $FILE

#           # Ghost blink animation
#           sed -i 's/fill="#ff0000"/fill="#ff0000"><animate attributeName="opacity" values="1;0.4;1" dur="1.2s" repeatCount="indefinite" \/><\/circle>/' $FILE

#           # Maze glow (path pulse)
#           sed -i 's/stroke="#444444"/stroke="#444444"><animate attributeName="stroke" values="#444444;#22c55e;#444444" dur="3s" repeatCount="indefinite" \/><\/path>/' $FILE

#       - name: Publish Animated SVG
#         uses: crazy-max/ghaction-github-pages@v2.1.3
#         with:
#           target_branch: output


# =========================
# 3D SNAKE MODE
# =========================
- name: 3D Snake Grid Animation
  if: ${{ github.event.inputs.game == 'snake3d' }}
  run: |
    mkdir -p dist
    cat > dist/heatmap.svg << 'EOF'
<svg width="100%" height="260" viewBox="0 0 1400 260" xmlns="http://www.w3.org/2000/svg">

  <defs>
    <linearGradient id="bgGrad" x1="0" x2="1" y1="0" y2="1">
      <stop offset="0%" stop-color="#0a0f1f"/>
      <stop offset="100%" stop-color="#111827"/>
    </linearGradient>

    <linearGradient id="cube" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#1f2937"/>
      <stop offset="100%" stop-color="#111827"/>
    </linearGradient>

    <linearGradient id="snakeGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#22c55e"/>
      <stop offset="100%" stop-color="#4ade80"/>
    </linearGradient>
  </defs>

  <rect width="100%" height="100%" fill="url(#bgGrad)" />

  <!-- == grid == -->
  <g opacity="0.7">
    <rect width="26" height="26" x="0" y="0" fill="url(#cube)">
      <animate attributeName="x" values="0;1400" dur="1s" repeatCount="indefinite" />
    </rect>
  </g>

  <!-- == snake == -->
  <g id="snake">
    <rect x="0" y="120" width="24" height="24" rx="4" fill="url(#snakeGrad)">
      <animate attributeName="x"
               values="0;200;400;600;800;1000;1200;1400"
               dur="6s"
               repeatCount="indefinite" />
      <animate attributeName="y"
               values="120;80;120;160;120"
               dur="3s"
               repeatCount="indefinite" />
    </rect>
  </g>

</svg>
EOF
